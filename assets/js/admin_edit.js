// Generated by CoffeeScript 1.6.3
(function() {
  $(document).ready(function() {
    var Checker, InputError, dispaly_error_info, hidden_error_info;
    $(".form_datetime").datetimepicker({
      format: "dd mm yyyy",
      autoclose: true,
      todayBtn: true,
      todayHightlight: true,
      startDate: "2011-09-08",
      minuteStep: 10,
      minView: 2
    });
    InputError = (function() {
      function InputError(flag, message) {
        if (flag == null) {
          flag = false;
        }
        if (message == null) {
          message = "";
        }
        this.flag = flag;
        this.message = message;
      }

      return InputError;

    })();
    Checker = (function() {
      function Checker() {
        this.error = new InputError(false);
      }

      Checker.prototype.event_date = function(date) {
        if (!/^[0-9]{1,2} [0-9]{2} [0-9]{4}$/.test(date)) {
          this.error = new InputError(true, "Event Date Input Error");
        }
        return this.error;
      };

      Checker.prototype.event_details = function(title, content) {
        if (title.length === 0 || content.length === 0) {
          this.error = new InputError(true, "Event Title And Content Not Empty");
        }
        return this.error;
      };

      return Checker;

    })();
    dispaly_error_info = function(error) {
      $("#l_alert").show();
      return $("#l_err").html(error);
    };
    hidden_error_info = function() {
      return $("#l_alert").hide();
    };
    $("#a_submit").click(function() {
      var a_event_content, a_event_date, a_event_title, a_id, check_date, check_detail, checker;
      hidden_error_info();
      a_event_date = $.trim($("#a_event_date").val());
      a_event_title = $.trim($("#a_event_title").val());
      a_event_content = $.trim($("#a_event_content").val());
      a_id = $.trim($("#a_hidden").val());
      console.log($("#a_event_date").val());
      console.log($("#a_event_title").val());
      console.log($("#a_event_content").val());
      console.log(a_id);
      checker = new Checker();
      check_date = checker.event_date(a_event_date);
      if (check_date.flag === true) {
        dispaly_error_info(check_date.message);
      } else {
        check_detail = checker.event_details(a_event_title, a_event_content);
        if (check_detail.flag === true) {
          dispaly_error_info(check_detail.message);
        } else {
          $.ajax({
            url: '/admin/edit',
            success: function(result) {
              console.log(eval('(' + result + ')'));
              result = eval('(' + result + ')');
              dispaly_error_info(result.info);
              window.location.href = '/admin/edit';
            },
            async: true,
            type: 'POST',
            data: {
              'e_date': a_event_date,
              'e_title': a_event_title,
              'e_content': a_event_content,
              'e_eid': a_id
            }
          });
        }
      }
      return true;
    });
  });

}).call(this);
