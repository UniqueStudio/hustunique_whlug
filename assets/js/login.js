// Generated by CoffeeScript 1.6.3
(function() {
  $(document).ready(function() {
    var Checker, InputError, dispaly_error_info, hidden_error_info;
    InputError = (function() {
      function InputError(flag, message) {
        if (flag == null) {
          flag = false;
        }
        if (message == null) {
          message = "";
        }
        this.flag = flag;
        this.message = message;
      }

      return InputError;

    })();
    Checker = (function() {
      function Checker() {
        this.error = new InputError(false);
      }

      Checker.prototype.student_no = function(stu_no) {
        if (!/[2011137][0-9]{2}/.test(stu_no)) {
          this.error = new InputError(true, "Student Number Input Error");
        }
        return this.error;
      };

      Checker.prototype.student_pwd = function(stu_pwd) {
        if (!/\d{9}/.test(stu_pwd)) {
          this.error = new InputError(true, "Password Input Error");
        }
        return this.error;
      };

      return Checker;

    })();
    dispaly_error_info = function(error) {
      $("#l_alert").show();
      return $("#l_err").html(error);
    };
    hidden_error_info = function() {
      return $("#l_alert").hide();
    };
    return $("#l_submit").click(function() {
      var check_stu_no, check_stu_pwd, checker, l_stu_no, l_stu_pwd;
      hidden_error_info();
      l_stu_no = $.trim($("#l_stu_no").val());
      l_stu_pwd = $.trim($("#l_stu_pwd").val());
      checker = new Checker();
      check_stu_no = checker.student_no(l_stu_no);
      if (check_stu_no.flag === true) {
        dispaly_error_info(check_stu_no.message);
      } else {
        check_stu_pwd = checker.student_pwd(l_stu_pwd);
        if (check_stu_pwd.flag === true) {
          dispaly_error_info(check_stu_pwd.message);
        } else {
          $.ajax({
            url: '/login',
            success: function(result) {
              console.log(eval('(' + result + ')'));
              result = eval('(' + result + ')');
              if (result.status === true) {
                window.location.href = '/home';
              }
              dispaly_error_info(result.info);
            },
            async: true,
            type: 'POST',
            data: {
              'l_stu_no': l_stu_no,
              'l_stu_pwd': md5(l_stu_pwd)
            }
          });
        }
      }
      return true;
    });
  });

}).call(this);
